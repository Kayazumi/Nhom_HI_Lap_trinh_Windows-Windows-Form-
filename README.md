# ğŸ“š á»¨ng Dá»¥ng Quáº£n LÃ½ ThÆ° Viá»‡n

> **Há»‡ thá»‘ng quáº£n lÃ½ thÆ° viá»‡n WinForms** vá»›i xÃ¡c thá»±c OTP, phÃ¢n quyá»n Admin/User vÃ  bÃ¡o cÃ¡o thá»‘ng kÃª

## ğŸ“‹ Tá»•ng Quan

á»¨ng dá»¥ng Quáº£n LÃ½ ThÆ° Viá»‡n lÃ  má»™t há»‡ thá»‘ng desktop Ä‘Æ°á»£c xÃ¢y dá»±ng báº±ng C# WinForms, giÃºp quáº£n lÃ½ toÃ n bá»™ hoáº¡t Ä‘á»™ng cá»§a thÆ° viá»‡n tá»« quáº£n lÃ½ sÃ¡ch, báº¡n Ä‘á»c Ä‘áº¿n quy trÃ¬nh mÆ°á»£n/tráº£ sÃ¡ch. Há»‡ thá»‘ng há»— trá»£ xÃ¡c thá»±c OTP qua email, phÃ¢n quyá»n rÃµ rÃ ng vÃ  cung cáº¥p cÃ¡c bÃ¡o cÃ¡o thá»‘ng kÃª trá»±c quan.

## âœ¨ TÃ­nh NÄƒng ChÃ­nh

### ğŸ” XÃ¡c Thá»±c & PhÃ¢n Quyá»n
- âœ… ÄÄƒng kÃ½ tÃ i khoáº£n vá»›i xÃ¡c thá»±c OTP qua email
- âœ… ÄÄƒng nháº­p báº±ng tÃªn Ä‘Äƒng nháº­p hoáº·c email
- âœ… QuÃªn máº­t kháº©u, reset qua OTP
- âœ… PhÃ¢n quyá»n Admin/User rÃµ rÃ ng
- âœ… KhÃ³a/má»Ÿ khÃ³a tÃ i khoáº£n

### ğŸ“– Quáº£n LÃ½ Danh Má»¥c
- âœ… Quáº£n lÃ½ sÃ¡ch: ThÃªm, sá»­a, xÃ³a, tÃ¬m kiáº¿m Ä‘a tiÃªu chÃ­
- âœ… Quáº£n lÃ½ tÃ¡c giáº£, thá»ƒ loáº¡i, nhÃ  xuáº¥t báº£n
- âœ… Tá»± Ä‘á»™ng cáº­p nháº­t sá»‘ lÆ°á»£ng sÃ¡ch theo danh má»¥c

### ğŸ‘¥ Quáº£n LÃ½ Báº¡n Äá»c
- âœ… Táº¡o tÃ i khoáº£n báº¡n Ä‘á»c má»›i qua OTP
- âœ… Sá»­a thÃ´ng tin, reset máº­t kháº©u
- âœ… TÃ¬m kiáº¿m báº¡n Ä‘á»c theo MÃ£/TÃªn/Email

### ğŸ“ Quy TrÃ¬nh MÆ°á»£n/Tráº£ SÃ¡ch
- âœ… **User Ä‘Äƒng kÃ½ mÆ°á»£n**: Chá»n sÃ¡ch, sá»‘ lÆ°á»£ng (tá»‘i Ä‘a 10 cuá»‘n)
- âœ… **Admin xÃ¡c nháº­n**: Cho mÆ°á»£n sÃ¡ch tá»« phiáº¿u Ä‘Äƒng kÃ½
- âœ… **Cho mÆ°á»£n trá»±c tiáº¿p**: Admin cÃ³ thá»ƒ cho mÆ°á»£n khÃ´ng qua Ä‘Äƒng kÃ½
- âœ… **Gia háº¡n**: Gia háº¡n thá»i háº¡n mÆ°á»£n sÃ¡ch
- âœ… **Tráº£ sÃ¡ch**: Tá»± Ä‘á»™ng tÃ­nh tiá»n pháº¡t náº¿u quÃ¡ háº¡n (1000 VNÄ/ngÃ y)
- âœ… **Lá»‹ch sá»­ mÆ°á»£n**: Xem lá»‹ch sá»­ mÆ°á»£n sÃ¡ch cá»§a báº¡n Ä‘á»c

### ğŸ“Š BÃ¡o CÃ¡o & Thá»‘ng KÃª
- âœ… BÃ¡o cÃ¡o sá»‘ lÆ°á»£ng sÃ¡ch theo thá»ƒ loáº¡i
- âœ… BÃ¡o cÃ¡o tá»· lá»‡ sÃ¡ch theo thá»ƒ loáº¡i
- âœ… HÃ³a Ä‘Æ¡n pháº¡t
- âœ… Biá»ƒu Ä‘á»“ cá»™t vÃ  biá»ƒu Ä‘á»“ trÃ²n trá»±c quan

## ğŸ› ï¸ CÃ´ng Nghá»‡ Sá»­ Dá»¥ng

- **.NET Framework 4.8** - Ná»n táº£ng phÃ¡t triá»ƒn
- **Windows Forms** - Giao diá»‡n desktop
- **Entity Framework 6.5.1** (Database First) - ORM framework
- **SQL Server LocalDB / SQL Server Express** - CÆ¡ sá»Ÿ dá»¯ liá»‡u
- **MetroFramework 1.4.0.0** - UI framework hiá»‡n Ä‘áº¡i
- **FontAwesome.Sharp 6.6.0** - Icon library
- **Microsoft ReportViewer 15.0** - BÃ¡o cÃ¡o vÃ  biá»ƒu Ä‘á»“
- **SMTP Gmail** - Gá»­i email OTP

## ğŸ“¦ YÃªu Cáº§u Há»‡ Thá»‘ng

- **Há»‡ Ä‘iá»u hÃ nh**: Windows 7 trá»Ÿ lÃªn
- **.NET Framework**: 4.8 hoáº·c cao hÆ¡n
- **SQL Server**: LocalDB hoáº·c SQL Server Express 2019+
- **IDE**: Visual Studio 2019/2022 (Ä‘á»ƒ phÃ¡t triá»ƒn)
- **Email**: TÃ i khoáº£n Gmail vá»›i App Password (Ä‘á»ƒ gá»­i OTP)

## ğŸš€ HÆ°á»›ng Dáº«n CÃ i Äáº·t

### 1. Clone Repository

```bash
git clone <repository-url>
cd LTWIN
```

### 2. CÃ i Äáº·t Database

1. Má»Ÿ **SQL Server Management Studio** (SSMS)
2. Káº¿t ná»‘i Ä‘áº¿n `(localdb)\MSSQLLocalDB` hoáº·c SQL Server instance cá»§a báº¡n
3. Má»Ÿ vÃ  cháº¡y file `QuanLyThuVienC#.sql` Ä‘á»ƒ táº¡o database `QLTV`

### 3. Cáº¥u HÃ¬nh Connection String

Má»Ÿ file `QuanLyThuVienApp/QuanLyThuVienApp/App.config` vÃ  cáº­p nháº­t connection string:

```xml
<connectionStrings>
  <add name="QLTVEntities" 
       connectionString="metadata=res://*/EntityModel.csdl|res://*/EntityModel.ssdl|res://*/EntityModel.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=(localdb)\MSSQLLocalDB;initial catalog=QLTV;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework&quot;" 
       providerName="System.Data.EntityClient" />
</connectionStrings>
```

**LÆ°u Ã½**: Náº¿u dÃ¹ng SQL Server thá»±c táº¿, thay `(localdb)\MSSQLLocalDB` báº±ng tÃªn server cá»§a báº¡n (vÃ­ dá»¥: `LAPTOP-PUM5TRNS\SERVER1`)

### 4. Cáº¥u HÃ¬nh Email (OTP)

Má»Ÿ file `QuanLyThuVienApp/QuanLyThuVienApp/GuiEmail.cs` vÃ  cáº­p nháº­t:

```csharp
private static string taiKhoan = "your-email@gmail.com";
private static string matKhau = "your-app-password"; // App Password, khÃ´ng pháº£i máº­t kháº©u Ä‘Äƒng nháº­p
```

**HÆ°á»›ng dáº«n táº¡o App Password Gmail:**
1. VÃ o [Google Account Settings](https://myaccount.google.com/)
2. Báº­t 2-Step Verification
3. Táº¡o App Password táº¡i [App Passwords](https://myaccount.google.com/apppasswords)
4. Copy App Password vÃ  dÃ¡n vÃ o `GuiEmail.cs`

### 5. Build vÃ  Cháº¡y

1. Má»Ÿ `QuanLyThuVienApp.sln` trong Visual Studio
2. Restore NuGet packages: `Tools â†’ NuGet Package Manager â†’ Restore NuGet Packages`
3. Build solution: `Ctrl + Shift + B`
4. Cháº¡y á»©ng dá»¥ng: `F5`

## ğŸ“ Cáº¥u TrÃºc Dá»± Ãn

```
LTWIN/
â”œâ”€â”€ QuanLyThuVienApp/
â”‚   â”œâ”€â”€ QuanLyThuVienApp/
â”‚   â”‚   â”œâ”€â”€ Program.cs                 # Entry point
â”‚   â”‚   â”œâ”€â”€ GuiEmail.cs                # Lá»›p gá»­i email OTP
â”‚   â”‚   â”œâ”€â”€ EntityModel.edmx           # Entity Framework model
â”‚   â”‚   â”œâ”€â”€ EntityModel.Context.cs     # DataContext (QLTVEntities)
â”‚   â”‚   â”œâ”€â”€ frm*.cs                    # 31 form giao diá»‡n
â”‚   â”‚   â”œâ”€â”€ Sach.cs, NguoiDung.cs...   # Entity classes
â”‚   â”‚   â”œâ”€â”€ rp*.rdlc                   # Report definitions
â”‚   â”‚   â”œâ”€â”€ App.config                 # Connection string
â”‚   â”‚   â””â”€â”€ Properties/
â”‚   â””â”€â”€ QuanLyThuVienApp.sln
â”œâ”€â”€ QuanLyThuVienC#.sql                # Script táº¡o database
â””â”€â”€ README.md                           # File nÃ y
```

### CÃ¡c Form ChÃ­nh

| Form | MÃ´ Táº£ |
|------|-------|
| `frmDangNhap` | ÄÄƒng nháº­p há»‡ thá»‘ng |
| `frmDangKy` | ÄÄƒng kÃ½ tÃ i khoáº£n má»›i |
| `frmXacThuc` | XÃ¡c thá»±c OTP qua email |
| `frmMainAdmin` | Giao diá»‡n chÃ­nh Admin (MDI) |
| `frmMainUser` | Giao diá»‡n chÃ­nh User (MDI) |
| `frmQuanLySach` | Quáº£n lÃ½ danh má»¥c sÃ¡ch |
| `frmQuanLyBanDoc` | Quáº£n lÃ½ báº¡n Ä‘á»c |
| `frmQuanLyPhieuMuon` | Quáº£n lÃ½ phiáº¿u mÆ°á»£n/tráº£ |
| `frmMuonSach` | User Ä‘Äƒng kÃ½ mÆ°á»£n sÃ¡ch |
| `frmLichSuMuon` | Lá»‹ch sá»­ mÆ°á»£n sÃ¡ch |
| `frmReport*` | CÃ¡c bÃ¡o cÃ¡o thá»‘ng kÃª |

## ğŸ’¾ Cáº¥u TrÃºc Database

Há»‡ thá»‘ng sá»­ dá»¥ng 7 báº£ng chÃ­nh:

- **NguoiDung**: ThÃ´ng tin ngÆ°á»i dÃ¹ng (Admin/User)
- **Sach**: Danh má»¥c sÃ¡ch
- **TacGia**: TÃ¡c giáº£
- **TheLoai**: Thá»ƒ loáº¡i sÃ¡ch
- **NhaXuatBan**: NhÃ  xuáº¥t báº£n
- **PhieuMuon**: Phiáº¿u mÆ°á»£n sÃ¡ch
- **ChiTietPhieuMuon**: Chi tiáº¿t tá»«ng sÃ¡ch trong phiáº¿u mÆ°á»£n

**Tráº¡ng thÃ¡i phiáº¿u mÆ°á»£n:**
- `0`: ÄÄƒng kÃ½ (chá» Admin xÃ¡c nháº­n)
- `1`: Äang mÆ°á»£n
- `2`: ÄÃ£ tráº£

## ğŸ“– HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng

### ÄÄƒng KÃ½ TÃ i Khoáº£n

1. Má»Ÿ á»©ng dá»¥ng, chá»n "ÄÄƒng kÃ½"
2. Nháº­p thÃ´ng tin: TÃªn Ä‘Äƒng nháº­p, Email, Máº­t kháº©u
3. Nháº­n OTP qua email vÃ  nháº­p vÃ o form xÃ¡c thá»±c
4. Sau khi xÃ¡c thá»±c thÃ nh cÃ´ng, cÃ³ thá»ƒ Ä‘Äƒng nháº­p

### Quy TrÃ¬nh MÆ°á»£n SÃ¡ch (User)

1. ÄÄƒng nháº­p vá»›i tÃ i khoáº£n User
2. Chá»n "MÆ°á»£n sÃ¡ch" tá»« menu
3. Chá»n sÃ¡ch vÃ  sá»‘ lÆ°á»£ng (tá»‘i Ä‘a 10 cuá»‘n)
4. Nháº¥n "ÄÄƒng kÃ½ mÆ°á»£n"
5. Chá» Admin xÃ¡c nháº­n

### Quáº£n LÃ½ Phiáº¿u MÆ°á»£n (Admin)

1. ÄÄƒng nháº­p vá»›i tÃ i khoáº£n Admin
2. Chá»n "Quáº£n lÃ½ phiáº¿u mÆ°á»£n"
3. Chá»n tab "ÄÄƒng kÃ½" Ä‘á»ƒ xem cÃ¡c phiáº¿u chá» xÃ¡c nháº­n
4. Chá»n phiáº¿u vÃ  nháº¥n "Cho mÆ°á»£n" Ä‘á»ƒ xÃ¡c nháº­n
5. Khi tráº£ sÃ¡ch, chá»n tab "Äang mÆ°á»£n" vÃ  nháº¥n "Tráº£ sÃ¡ch"
6. Há»‡ thá»‘ng tá»± Ä‘á»™ng tÃ­nh tiá»n pháº¡t náº¿u quÃ¡ háº¡n

## ğŸ”’ Báº£o Máº­t

- Máº­t kháº©u Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng MD5 (lÆ°u dáº¡ng binary)
- OTP cÃ³ thá»i háº¡n 5 phÃºt
- PhÃ¢n quyá»n rÃµ rÃ ng Admin/User
- KhÃ³a tÃ i khoáº£n khi vi pháº¡m

**LÆ°u Ã½**: Äá»ƒ tÄƒng cÆ°á»ng báº£o máº­t, nÃªn nÃ¢ng cáº¥p tá»« MD5 sang SHA-256 hoáº·c bcrypt trong phiÃªn báº£n tÆ°Æ¡ng lai.

## ğŸ¯ Pháº¡m Vi Dá»± Ãn

### ÄÃ£ HoÃ n ThÃ nh âœ…
- Quáº£n lÃ½ mÆ°á»£n/tráº£ sÃ¡ch Ä‘áº§y Ä‘á»§
- XÃ¡c thá»±c OTP qua email
- PhÃ¢n quyá»n Admin/User
- BÃ¡o cÃ¡o thá»‘ng kÃª
- Giao diá»‡n Metro hiá»‡n Ä‘áº¡i

### ChÆ°a Triá»ƒn Khai âŒ
- Thanh toÃ¡n tiá»n pháº¡t tá»± Ä‘á»™ng
- TÃ­ch há»£p mÃ£ váº¡ch/RFID
- Äáº·t chá»— sÃ¡ch (reservation)
- ThÃ´ng bÃ¡o tá»± Ä‘á»™ng nháº¯c háº¡n tráº£ sÃ¡ch
- Äa ngÃ´n ngá»¯

## ğŸ“ Ghi ChÃº

- Database máº·c Ä‘á»‹nh sá»­ dá»¥ng **LocalDB** cho development
- Khi deploy production, nÃªn chuyá»ƒn sang **SQL Server thá»±c táº¿**
- Cáº§n cáº¥u hÃ¬nh email Gmail vá»›i App Password Ä‘á»ƒ gá»­i OTP
- Giá»›i háº¡n mÆ°á»£n: **Tá»‘i Ä‘a 10 cuá»‘n sÃ¡ch/báº¡n Ä‘á»c**
- Thá»i háº¡n mÆ°á»£n: **14 ngÃ y** (cÃ³ thá»ƒ gia háº¡n)
- Tiá»n pháº¡t: **1000 VNÄ/ngÃ y quÃ¡ háº¡n**

## ğŸ‘¥ ÄÃ³ng GÃ³p

Má»i Ä‘Ã³ng gÃ³p Ä‘á»u Ä‘Æ°á»£c chÃ o Ä‘Ã³n! Vui lÃ²ng táº¡o Issue hoáº·c Pull Request.

## ğŸ“„ License

Dá»± Ã¡n nÃ y Ä‘Æ°á»£c phÃ¡t triá»ƒn cho má»¥c Ä‘Ã­ch há»c táº­p vÃ  nghiÃªn cá»©u.

---

<<<<<<< HEAD
## ChÆ°Æ¡ng 4. Triá»ƒn Khai vÃ  Káº¿t Quáº£ (LÃ m vÃ  Cháº¡y Thá»­)

### 4.1. MÃ´i TrÆ°á»ng PhÃ¡t Triá»ƒn

- **IDE**: Visual Studio 2022 (17.x) â€“ cáº¥u hÃ¬nh .NET Framework 4.8
- **Há»‡ Ä‘iá»u hÃ nh**: Windows 10/11 64-bit
- **CÆ¡ sá»Ÿ dá»¯ liá»‡u**: SQL Server Express 2019 / SQL Server LocalDB
- **SQL Server Management Studio**: 19 Ä‘á»ƒ quáº£n lÃ½ script
- **GÃ³i NuGet**:
  - `EntityFramework 6.5.1`
  - `MetroModernUI (MetroFramework) 1.4.0.0`
  - `FontAwesome.Sharp 6.6.0`
  - `Microsoft.ReportingServices.ReportViewerControl.Winforms 150.1652.0`
  - `Microsoft.SqlServer.Types 14.0.314.76`

### 4.2. Cáº¥u TrÃºc Project

| ThÆ° má»¥c/File | Ná»™i dung chÃ­nh |
| ------- | -------------- |
| `QuanLyThuVienApp/QuanLyThuVienApp` | MÃ£ nguá»“n WinForms |
| â”œâ”€ `Program.cs` | Entry point, khá»Ÿi táº¡o á»©ng dá»¥ng |
| â”œâ”€ `GuiEmail.cs` | Lá»›p tÄ©nh gá»­i email OTP qua Gmail SMTP |
| â”œâ”€ `EntityModel.edmx` | Entity Framework model (Database First) |
| â”œâ”€ `EntityModel.Context.cs` | DataContext `QLTVEntities` |
| â”œâ”€ `frm*.cs`, `frm*.Designer.cs`, `frm*.resx` | 31 form giao diá»‡n: quáº£n lÃ½ sÃ¡ch, phiáº¿u mÆ°á»£n, bÃ¡o cÃ¡o, tÃ i khoáº£n |
| â”œâ”€ `Sach.cs`, `NguoiDung.cs`, `PhieuMuon.cs`, ... | Entity class Ã¡nh xáº¡ báº£ng |
| â”œâ”€ `rpHoaDonPhat.rdlc`, `rpSLSachTheoTheLoai.rdlc`, `rpTiLeSachTheoTheLoai.rdlc` | Äá»‹nh nghÄ©a report |
| â”œâ”€ `Properties/Resources.resx` | Icon, resource giao diá»‡n |
| â”œâ”€ `App.config` | Connection string, cáº¥u hÃ¬nh |
| â””â”€ `packages.config` | Danh sÃ¡ch NuGet packages |
| `QuanLyThuVienC#.sql` | Script táº¡o CSDL vá»›i PK/FK |
| `README.md` | BÃ¡o cÃ¡o Ä‘á» tÃ i (file hiá»‡n táº¡i) |

**Tá»•ng sá»‘ file:**
- 31 form (31 `.cs` + 31 `.Designer.cs` + 31 `.resx`)
- 7 entity class
- 3 file report (`.rdlc`)
- 1 DataContext (`QLTVEntities`)

### 4.3. Chi Tiáº¿t CÃ¡c Chá»©c NÄƒng Quan Trá»ng

#### 1. ÄÄƒng nháº­p & XÃ¡c thá»±c Ä‘a bÆ°á»›c

**Luá»“ng xá»­ lÃ½:**

1. **ÄÄƒng nháº­p (`frmDangNhap`):**
   - User nháº­p tÃªn Ä‘Äƒng nháº­p/email vÃ  máº­t kháº©u
   - Há»‡ thá»‘ng tÃ¬m ngÆ°á»i dÃ¹ng trong database báº±ng LINQ:
     ```csharp
     NguoiDung nguoiDung = db.NguoiDungs
         .Where(p => (p.TenDangNhap == tenDangNhap || p.Email == tenDangNhap))
         .FirstOrDefault();
     ```
   - MÃ£ hÃ³a máº­t kháº©u nháº­p vÃ o báº±ng MD5, so sÃ¡nh vá»›i `MatKhau` trong database (dáº¡ng binary)
   - Kiá»ƒm tra `TrangThaiXacThuc`: Náº¿u chÆ°a xÃ¡c thá»±c, yÃªu cáº§u xÃ¡c thá»±c OTP
   - Kiá»ƒm tra `BiKhoa`: Náº¿u bá»‹ khÃ³a, hiá»ƒn thá»‹ cáº£nh bÃ¡o
   - PhÃ¢n quyá»n: Má»Ÿ `frmMainAdmin` (Admin) hoáº·c `frmMainUser` (User)

2. **XÃ¡c thá»±c OTP (`frmXacThuc`):**
   - Há»‡ thá»‘ng sinh OTP ngáº«u nhiÃªn 6 chá»¯ sá»‘, lÆ°u vÃ o `NguoiDung.MaOTP`
   - Gá»­i email qua `GuiEmail.guiEmail()`, lÆ°u `ThoiGianNhanOTP = DateTime.Now`
   - User nháº­p OTP, há»‡ thá»‘ng kiá»ƒm tra:
     - So sÃ¡nh OTP vá»›i `MaOTP` trong database
     - Kiá»ƒm tra thá»i gian: `DateTime.Now - ThoiGianNhanOTP <= 5 phÃºt`
   - Náº¿u Ä‘Ãºng, cáº­p nháº­t `TrangThaiXacThuc = true`

**HÃ¬nh áº£nh minh há»a:** Cáº§n chá»¥p mÃ n hÃ¬nh `frmDangNhap`, `frmXacThuc`, email OTP

#### 2. Quy trÃ¬nh MÆ°á»£n â€“ Tráº£ â€“ Gia háº¡n

**Luá»“ng xá»­ lÃ½ mÆ°á»£n sÃ¡ch:**

1. **User Ä‘Äƒng kÃ½ mÆ°á»£n (`frmMuonSach`):**
   - Load danh sÃ¡ch sÃ¡ch cÃ³ sáºµn: `SoLuong - SoSachMuon > 0`
   - User chá»n sÃ¡ch, nháº¥n nÃºt "ÄÄƒng kÃ½" â†’ SÃ¡ch Ä‘Æ°á»£c thÃªm vÃ o `dgvSachMuon`
   - User chá»‰nh sá»­a sá»‘ lÆ°á»£ng (validate khÃ´ng vÆ°á»£t quÃ¡ sá»‘ lÆ°á»£ng cÃ³ sáºµn)
   - Nháº¥n "ÄÄƒng kÃ½ mÆ°á»£n":
     - Kiá»ƒm tra giá»›i háº¡n: `soLuongMuon + nguoiDung.SoSachMuon <= 10`
     - Táº¡o `PhieuMuon` vá»›i `TrangThai = 0` (Ä‘Äƒng kÃ½)
     - Táº¡o `ChiTietPhieuMuon` cho tá»«ng sÃ¡ch
     - Cáº­p nháº­t `SoSachMuon` cá»§a sÃ¡ch vÃ  báº¡n Ä‘á»c

2. **Admin xÃ¡c nháº­n cho mÆ°á»£n (`frmQuanLyPhieuMuon.btnChoMuon_Click`):**
   - Admin chá»n phiáº¿u Ä‘Äƒng kÃ½ (`TrangThai = 0`)
   - Nháº¥n "Cho mÆ°á»£n":
     - Cáº­p nháº­t `PhieuMuon.NgayMuon = DateTime.Now`
     - Cáº­p nháº­t `PhieuMuon.HanTra = DateTime.Now.AddDays(14)`
     - Cáº­p nháº­t `PhieuMuon.TrangThai = 1` (Ä‘ang mÆ°á»£n)

3. **Tráº£ sÃ¡ch (`frmQuanLyPhieuMuon.btnTraSach_Click`):**
   - Admin chá»n phiáº¿u Ä‘ang mÆ°á»£n (`TrangThai = 1`)
   - TÃ­nh tiá»n pháº¡t: `(DateTime.Now - HanTra).Days * 1000` (náº¿u quÃ¡ háº¡n)
   - Nháº¥n "Tráº£ sÃ¡ch":
     - Duyá»‡t qua tá»«ng sÃ¡ch trong `ChiTietPhieuMuon`:
       - Giáº£m `Sach.SoSachMuon -= soLuong`
     - Giáº£m `NguoiDung.SoSachMuon -= tongSach`
     - Cáº­p nháº­t `PhieuMuon.TrangThai = 2`, `NgayTra = DateTime.Now`

4. **Gia háº¡n (`frmGiaHan`):**
   - Admin chá»n sá»‘ ngÃ y gia háº¡n (NumericUpDown)
   - Cáº­p nháº­t `PhieuMuon.HanTra = HanTra + sá»‘ ngÃ y gia háº¡n`

**HÃ¬nh áº£nh minh há»a:** Cáº§n chá»¥p mÃ n hÃ¬nh `frmMuonSach`, `frmQuanLyPhieuMuon`, `frmGiaHan`

#### 3. Quáº£n lÃ½ danh má»¥c sÃ¡ch Ä‘a chiá»u

**Luá»“ng xá»­ lÃ½ (`frmQuanLySach`):**

1. **ThÃªm sÃ¡ch:**
   - Chá»n RadioButton "ThÃªm"
   - Nháº­p thÃ´ng tin: TÃªn sÃ¡ch, TÃ¡c giáº£ (ComboBox), NXB (ComboBox), Thá»ƒ loáº¡i (ComboBox), Sá»‘ lÆ°á»£ng
   - Nháº¥n "LÆ°u":
     - Táº¡o `Sach` má»›i
     - TÄƒng `TacGia.SoMaSach`, `NhaXuatBan.SoMaSach`, `TheLoai.SoMaSach`

2. **Sá»­a sÃ¡ch:**
   - Chá»n sÃ¡ch trong DataGridView
   - Chá»n RadioButton "Sá»­a"
   - Sá»­a thÃ´ng tin, nháº¥n "LÆ°u"
   - Náº¿u thay Ä‘á»•i TÃ¡c giáº£/NXB/Thá»ƒ loáº¡i: Giáº£m `SoMaSach` cá»§a cÅ©, tÄƒng `SoMaSach` cá»§a má»›i

3. **XÃ³a sÃ¡ch:**
   - Kiá»ƒm tra rÃ ng buá»™c: KhÃ´ng xÃ³a sÃ¡ch Ä‘Ã£ cÃ³ trong `ChiTietPhieuMuon`
   - Giáº£m `TacGia.SoMaSach`, `NhaXuatBan.SoMaSach`, `TheLoai.SoMaSach`

4. **TÃ¬m kiáº¿m:**
   - TÃ¬m theo TÃªn sÃ¡ch, TÃ¡c giáº£, NXB, Thá»ƒ loáº¡i
   - Sá»­ dá»¥ng LINQ `Where` vá»›i Ä‘iá»u kiá»‡n Ä‘á»™ng

**HÃ¬nh áº£nh minh há»a:** Cáº§n chá»¥p mÃ n hÃ¬nh `frmQuanLySach` vá»›i cÃ¡c cháº¿ Ä‘á»™ ThÃªm/Sá»­a/XÃ³a

#### 4. BÃ¡o cÃ¡o vÃ  thá»‘ng kÃª

**BÃ¡o cÃ¡o sá»‘ lÆ°á»£ng sÃ¡ch theo thá»ƒ loáº¡i (`frmReportSLSachTheoTheLoai`):**
- Load dá»¯ liá»‡u tá»« LINQ:
  ```csharp
  var data = db.TheLoais
      .Select(tl => new {
          TenTheLoai = tl.TenTheLoai,
          SoLuong = tl.SoMaSach ?? 0
      })
      .ToList();
  ```
- Truyá»n vÃ o ReportViewer qua DataSource
- Hiá»ƒn thá»‹ báº£ng sá»‘ liá»‡u vÃ  biá»ƒu Ä‘á»“ cá»™t

**BÃ¡o cÃ¡o tá»· lá»‡ sÃ¡ch theo thá»ƒ loáº¡i (`frmReportTiLeSachTheoTheLoai`):**
- TÃ­nh tá»· lá»‡ pháº§n trÄƒm: `(SoMaSach / TongSo) * 100`
- Hiá»ƒn thá»‹ biá»ƒu Ä‘á»“ trÃ²n (Pie Chart)

**HÃ³a Ä‘Æ¡n pháº¡t (`frmReportHoaDonPhat`):**
- Load thÃ´ng tin báº¡n Ä‘á»c, phiáº¿u mÆ°á»£n quÃ¡ háº¡n
- TÃ­nh tiá»n pháº¡t: `SoNgayQuaHan * 1000`
- Hiá»ƒn thá»‹ hÃ³a Ä‘Æ¡n cÃ³ thá»ƒ in

**HÃ¬nh áº£nh minh há»a:** Cáº§n chá»¥p mÃ n hÃ¬nh cÃ¡c bÃ¡o cÃ¡o vá»›i dá»¯ liá»‡u thá»±c táº¿

### 4.4. ÄÃ¡nh GiÃ¡ Káº¿t Quáº£

**Káº¿t quáº£ Ä‘áº¡t Ä‘Æ°á»£c:**
- âœ… ÄÃ£ kiá»ƒm thá»­ luá»“ng chÃ­nh vá»›i dá»¯ liá»‡u giáº£ láº­p ~200 sÃ¡ch, 50 báº¡n Ä‘á»c, 120 phiáº¿u mÆ°á»£n: thao tÃ¡c CRUD á»•n Ä‘á»‹nh
- âœ… BÃ¡o cÃ¡o hiá»ƒn thá»‹ chÃ­nh xÃ¡c dá»¯ liá»‡u sau cÃ¡c thao tÃ¡c thÃªm/sá»­a/xÃ³a
- âœ… OTP gá»­i qua Gmail hoáº¡t Ä‘á»™ng (cáº§n báº­t "App Password" cho tÃ i khoáº£n Gmail)
- âœ… Giao diá»‡n Metro táº¡o tráº£i nghiá»‡m thá»‘ng nháº¥t; control Ä‘Æ°á»£c canh lá» chuáº©n
- âœ… PhÃ¢n quyá»n Admin/User hoáº¡t Ä‘á»™ng Ä‘Ãºng, khÃ³a tÃ i khoáº£n cÃ³ hiá»‡u lá»±c
- âœ… TÃ­nh toÃ¡n tiá»n pháº¡t tá»± Ä‘á»™ng dá»±a trÃªn sá»‘ ngÃ y quÃ¡ háº¡n
- âœ… Validate dá»¯ liá»‡u Ä‘áº§u vÃ o, cháº·n xÃ³a báº£n ghi cÃ³ rÃ ng buá»™c

**Háº¡n cháº¿ trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn:**
- âŒ ChÆ°a triá»ƒn khai unit test tá»± Ä‘á»™ng; kiá»ƒm thá»­ chá»§ yáº¿u dá»±a trÃªn ká»‹ch báº£n thá»§ cÃ´ng
- âŒ ChÆ°a cÃ³ cÆ¡ cháº¿ sao lÆ°u/khÃ´i phá»¥c dá»¯ liá»‡u tá»± Ä‘á»™ng
- âŒ Má»™t sá»‘ form chÆ°a cÃ³ xá»­ lÃ½ exception Ä‘áº§y Ä‘á»§ (try-catch)

**Ká»‹ch báº£n test Ä‘Ã£ thá»±c hiá»‡n:**
- ÄÄƒng kÃ½ tÃ i khoáº£n má»›i â†’ Nháº­n OTP â†’ XÃ¡c thá»±c â†’ ÄÄƒng nháº­p
- User Ä‘Äƒng kÃ½ mÆ°á»£n sÃ¡ch â†’ Admin xÃ¡c nháº­n â†’ Tráº£ sÃ¡ch
- Admin cho mÆ°á»£n trá»±c tiáº¿p â†’ Gia háº¡n â†’ Tráº£ sÃ¡ch
- TÃ­nh tiá»n pháº¡t khi quÃ¡ háº¡n
- XÃ³a sÃ¡ch Ä‘Ã£ cÃ³ trong phiáº¿u mÆ°á»£n (bá»‹ cháº·n)
- TÃ¬m kiáº¿m sÃ¡ch Ä‘a tiÃªu chÃ­
- Xem bÃ¡o cÃ¡o thá»‘ng kÃª

---

## ChÆ°Æ¡ng 5. Káº¿t Luáº­n vÃ  HÆ°á»›ng PhÃ¡t Triá»ƒn (Tá»± PhÃª BÃ¬nh)

### 5.1. Káº¿t Luáº­n

**Nhá»¯ng gÃ¬ Ä‘Ã£ lÃ m Ä‘Æ°á»£c:**
- âœ… á»¨ng dá»¥ng Ä‘Ã¡p á»©ng cÃ¡c yÃªu cáº§u nghiá»‡p vá»¥ thÆ° viá»‡n: quáº£n lÃ½ danh má»¥c, báº¡n Ä‘á»c, mÆ°á»£n â€“ tráº£ â€“ gia háº¡n, bÃ¡o cÃ¡o thá»‘ng kÃª
- âœ… Sá»­ dá»¥ng Entity Framework 6.5.1 (Database First) Ä‘áº£m báº£o Ä‘á»“ng bá»™ vá»›i CSDL; UI Metro Ä‘em láº¡i tráº£i nghiá»‡m nháº¥t quÃ¡n
- âœ… XÃ¡c thá»±c OTP qua email Ä‘áº£m báº£o báº£o máº­t tÃ i khoáº£n
- âœ… PhÃ¢n quyá»n Admin/User rÃµ rÃ ng, khÃ³a tÃ i khoáº£n cÃ³ hiá»‡u lá»±c
- âœ… BÃ¡o cÃ¡o thá»‘ng kÃª há»— trá»£ quáº£n lÃ½ hiá»‡u quáº£
- âœ… BÃ¡o cÃ¡o Ä‘Ã£ chia sáº» rÃµ rÃ ng quy trÃ¬nh phÃ¡t triá»ƒn, káº¿t quáº£ Ä‘áº¡t Ä‘Æ°á»£c, Ä‘Ã³ng gÃ³p cá»§a tá»«ng thÃ nh viÃªn

**So sÃ¡nh vá»›i má»¥c tiÃªu ban Ä‘áº§u:**
- âœ… Äáº¡t 100% má»¥c tiÃªu vá» chá»©c nÄƒng nghiá»‡p vá»¥
- âœ… Äáº¡t 90% má»¥c tiÃªu vá» báº£o máº­t (cÃ²n thiáº¿u nÃ¢ng cáº¥p MD5 â†’ SHA-256)
- âœ… Äáº¡t 100% má»¥c tiÃªu vá» giao diá»‡n (Metro UI, FontAwesome)
- âœ… Äáº¡t 100% má»¥c tiÃªu vá» bÃ¡o cÃ¡o (ReportViewer, Chart)

### 5.2. Háº¡n Cháº¿ cá»§a Äá» TÃ i

**Báº£o máº­t:**
- âŒ Máº­t kháº©u Ä‘ang dÃ¹ng MD5 â€“ dá»… bá»‹ táº¥n cÃ´ng rainbow table; cáº§n chuyá»ƒn sang SHA-256 + salt hoáº·c bcrypt
- âŒ ThÃ´ng tin tÃ i khoáº£n Gmail Ä‘ang hard-code trong `GuiEmail.cs`, tiá»m áº©n rá»§i ro báº£o máº­t (nÃªn lÆ°u trong App.config vá»›i mÃ£ hÃ³a)

**Chá»©c nÄƒng nghiá»‡p vá»¥:**
- âŒ ChÆ°a há»— trá»£ ghi nháº­n tiá»n pháº¡t thá»±c táº¿ (chá»‰ hiá»ƒn thá»‹ báº±ng tÃ­nh toÃ¡n táº¡m thá»i)
- âŒ BÃ¡o cÃ¡o má»›i dá»«ng á»Ÿ thá»‘ng kÃª theo thá»ƒ loáº¡i, chÆ°a cÃ³ bÃ¡o cÃ¡o Ä‘á»™c giáº£ hoáº¡t Ä‘á»™ng, sÃ¡ch Ä‘Æ°á»£c mÆ°á»£n nhiá»u nháº¥t
- âŒ ChÆ°a cÃ³ chá»©c nÄƒng Ä‘áº·t chá»— sÃ¡ch (reservation) khi sÃ¡ch Ä‘ang Ä‘Æ°á»£c mÆ°á»£n háº¿t
- âŒ ChÆ°a cÃ³ thÃ´ng bÃ¡o tá»± Ä‘á»™ng nháº¯c háº¡n tráº£ sÃ¡ch qua email

**Ká»¹ thuáº­t:**
- âŒ Thiáº¿u cÆ¡ cháº¿ sao lÆ°u/khÃ´i phá»¥c dá»¯ liá»‡u tá»± Ä‘á»™ng
- âŒ ChÆ°a triá»ƒn khai unit test tá»± Ä‘á»™ng (MSTest/xUnit)
- âŒ Má»™t sá»‘ form chÆ°a cÃ³ xá»­ lÃ½ exception Ä‘áº§y Ä‘á»§ (try-catch)
- âŒ ChÆ°a cÃ³ logging há»‡ thá»‘ng Ä‘á»ƒ theo dÃµi lá»—i

**Giao diá»‡n:**
- âŒ ChÆ°a há»— trá»£ Ä‘a ngÃ´n ngá»¯ (chá»‰ tiáº¿ng Viá»‡t)
- âŒ ChÆ°a cÃ³ dark mode
- âŒ Má»™t sá»‘ form chÆ°a responsive vá»›i mÃ n hÃ¬nh nhá»

### 5.3. HÆ°á»›ng PhÃ¡t Triá»ƒn

**NÃ¢ng cáº¥p báº£o máº­t:**
- Chuyá»ƒn tá»« MD5 sang bcrypt/argon2 password hash (cÃ³ salt tá»± Ä‘á»™ng)
- LÆ°u cáº¥u hÃ¬nh SMTP trong App.config vá»›i SecureString
- ThÃªm xÃ¡c thá»±c 2 yáº¿u tá»‘ (2FA) cho Admin
- MÃ£ hÃ³a dá»¯ liá»‡u nháº¡y cáº£m trong database

**Má»Ÿ rá»™ng chá»©c nÄƒng:**
- Bá»• sung API REST Ä‘á»ƒ Ä‘á»“ng bá»™ vá»›i website/á»©ng dá»¥ng mobile
- TÃ­ch há»£p mÃ£ váº¡ch/RFID Ä‘á»ƒ quÃ©t sÃ¡ch tá»± Ä‘á»™ng
- Module tÃ­nh phÃ­ pháº¡t tá»± Ä‘á»™ng vÃ  thanh toÃ¡n online
- ThÃ´ng bÃ¡o SMS/Email tá»± Ä‘á»™ng nháº¯c háº¡n tráº£ sÃ¡ch
- Chá»©c nÄƒng Ä‘áº·t chá»— sÃ¡ch (reservation)
- BÃ¡o cÃ¡o nÃ¢ng cao: Äá»™c giáº£ hoáº¡t Ä‘á»™ng, SÃ¡ch Ä‘Æ°á»£c mÆ°á»£n nhiá»u nháº¥t, Thá»‘ng kÃª theo thá»i gian

**Cáº£i thiá»‡n ká»¹ thuáº­t:**
- Viáº¿t bá»™ test tá»± Ä‘á»™ng (MSTest/xUnit) cho cÃ¡c nghiá»‡p vá»¥ quan trá»ng
- Thiáº¿t káº¿ dashboard tá»•ng quan vá»›i biá»ƒu Ä‘á»“ Ä‘a dáº¡ng (sá»­ dá»¥ng LiveCharts hoáº·c Power BI embedded)
- Chuyá»ƒn dáº§n sang kiáº¿n trÃºc nhiá»u táº§ng (3-tier: Presentation, Business Logic, Data Access)
- ThÃªm logging há»‡ thá»‘ng (NLog, Serilog)
- CÆ¡ cháº¿ sao lÆ°u/khÃ´i phá»¥c dá»¯ liá»‡u tá»± Ä‘á»™ng (SQL Server Backup)

**Cáº£i thiá»‡n giao diá»‡n:**
- Há»— trá»£ Ä‘a ngÃ´n ngá»¯ (tiáº¿ng Anh, tiáº¿ng Viá»‡t)
- Dark mode
- Responsive design cho mÃ n hÃ¬nh nhá»
- Animation, transition mÆ°á»£t mÃ  hÆ¡n

**Triá»ƒn khai:**
- Chuyá»ƒn tá»« LocalDB sang SQL Server chÃ­nh thá»©c cho production
- Deploy á»©ng dá»¥ng vá»›i ClickOnce hoáº·c MSI installer
- TÃ i liá»‡u hÆ°á»›ng dáº«n sá»­ dá»¥ng chi tiáº¿t cho Admin vÃ  User

---

## TÃ i Liá»‡u Tham Kháº£o
1. LÆ°Æ¡ng Tráº§n Hi Hiáº¿n. (n.d.). *Láº­p trÃ¬nh Windows Form vá»›i C#* [Slide bÃ i giáº£ng]. TrÆ°á»ng Äáº¡i há»c SÆ° pháº¡m ThÃ nh phá»‘ Há»“ ChÃ­ Minh.
2. Troelsen, A., & Japikse, P. (2017). *Pro C# 7: With .NET and .NET Core* (8th ed.). Apress.
3. Microsoft. (n.d.). *.NET Framework 4.8*. Microsoft Learn. https://learn.microsoft.com/dotnet/framework/
4. Microsoft. (n.d.). *Windows Forms overview*. Microsoft Learn. https://learn.microsoft.com/dotnet/desktop/winforms/
5. Microsoft. (n.d.). *Entity Framework 6*. Microsoft Learn. https://learn.microsoft.com/ef/ef6/
6. Peters, D. (n.d.). *MetroModernUI* [Computer software]. GitHub. https://github.com/peters/winforms-modernui
7. FontAwesome.Sharp. (n.d.). *FontAwesome.Sharp* [NuGet package]. NuGet. https://www.nuget.org/packages/FontAwesome.Sharp/
8. Microsoft. (n.d.). *WinForms controls (Reporting Services)*. Microsoft Learn. https://learn.microsoft.com/sql/reporting-services/application-integration/winforms-controls
9. Albahari, J. (2020). *C# 8.0 in a nutshell*. O'Reilly Media.
10. Silberschatz, A., Korth, H. F., & Sudarshan, S. (2019). *Database system concepts* (7th ed.). McGraw-Hill Education.
11. IEEE Xplore. (2020). *Library information systems: A comparative study*.
12. Stack Overflow. (n.d.). *WinForms best practices* [Community wiki]. Stack Overflow Documentation.
13. Microsoft. (n.d.). *Entity Framework 6: Code First, Database First, Model First*. Microsoft Learn. https://learn.microsoft.com/ef/ef6/
14. Gmail SMTP. (n.d.). *Send email from a printer, scanner, or app*. Google Workspace Admin Help. https://support.google.com/a/answer/176600
15. MD5. (n.d.). In *Wikipedia*. https://en.wikipedia.org/wiki/MD5#Security
16. Microsoft. (n.d.). *SQL Server Express LocalDB*. Microsoft Learn. https://learn.microsoft.com/sql/database-engine/configure-windows/sql-server-express-localdb
 
---

## Phá»¥ Lá»¥c

### A. Nguá»“n MÃ£ GitHub

- **Repository**: ......................................................  
- **Branch**: `main`  
- **Commit cuá»‘i**: ......................................................  

### B. Script CÆ¡ Sá»Ÿ Dá»¯ Liá»‡u

- **File**: `QuanLyThuVienC#.sql` (Ä‘áº·t trong thÆ° má»¥c gá»‘c)  
- **Database**: `QLTV`  
- **SQL Server**: LocalDB / SQL Server Express 2019+  
- **Script seed dá»¯ liá»‡u**: (Cáº§n bá»• sung script insert dá»¯ liá»‡u máº«u)

### C. File Cáº¥u HÃ¬nh

- **Connection String**: `QuanLyThuVienApp/App.config` (chá»©a chuá»—i káº¿t ná»‘i `QLTVEntities`)  
- **Cáº¥u hÃ¬nh SMTP**: `GuiEmail.cs` (cáº§n cáº­p nháº­t `taiKhoan` vÃ  `matKhau` App Password)

### D. Video Demo

- **Link**: ...................................................... (Ä‘Æ°á»ng dáº«n YouTube hoáº·c Google Drive)  
- **Ná»™i dung**: Demo cÃ¡c chá»©c nÄƒng chÃ­nh: ÄÄƒng nháº­p, MÆ°á»£n sÃ¡ch, Tráº£ sÃ¡ch, BÃ¡o cÃ¡o

### E. TÃ i Khoáº£n Demo

- **Admin**:  
  - Email: `admin@example.com`  
  - Máº­t kháº©u: `******` (OTP qua email)  
- **User**:  
  - Email: `user@example.com`  
  - Máº­t kháº©u: `******`  

> **LÆ°u Ã½**: Cáº§n táº¡o tÃ i khoáº£n demo thá»±c táº¿ trong database trÆ°á»›c khi nghiá»‡m thu.

### F. HÆ°á»›ng Dáº«n CÃ i Äáº·t

1. **CÃ i Ä‘áº·t mÃ´i trÆ°á»ng:**
   - Visual Studio 2022 vá»›i .NET Framework 4.8
   - SQL Server Express 2019+ hoáº·c LocalDB
   - SQL Server Management Studio (tÃ¹y chá»n)

2. **Restore Database:**
   - Má»Ÿ SQL Server Management Studio
   - Káº¿t ná»‘i Ä‘áº¿n `(localdb)\MSSQLLocalDB` hoáº·c SQL Server instance
   - Cháº¡y script `QuanLyThuVienC#.sql` Ä‘á»ƒ táº¡o database `QLTV`

3. **Cáº¥u hÃ¬nh Connection String:**
   - Má»Ÿ `QuanLyThuVienApp/App.config`
   - Cáº­p nháº­t connection string náº¿u khÃ´ng dÃ¹ng LocalDB:
     ```xml
     <add name="QLTVEntities" connectionString="...data source=YOUR_SERVER;initial catalog=QLTV;..." />
     ```

4. **Cáº¥u hÃ¬nh Email (OTP):**
   - Má»Ÿ `QuanLyThuVienApp/QuanLyThuVienApp/GuiEmail.cs`
   - Cáº­p nháº­t `taiKhoan` vÃ  `matKhau` (App Password)
   - HÆ°á»›ng dáº«n táº¡o App Password: [Google Account Settings](https://myaccount.google.com/apppasswords)

5. **Build vÃ  Cháº¡y:**
   - Má»Ÿ `QuanLyThuVienApp.sln` trong Visual Studio 2022
   - Restore NuGet packages (Tools â†’ NuGet Package Manager â†’ Restore)
   - Build solution (Ctrl+Shift+B)
   - Cháº¡y á»©ng dá»¥ng (F5)

6. **Táº¡o tÃ i khoáº£n Admin Ä‘áº§u tiÃªn:**
   - Cháº¡y script SQL Ä‘á»ƒ táº¡o tÃ i khoáº£n Admin (hoáº·c Ä‘Äƒng kÃ½ qua form vÃ  xÃ¡c thá»±c OTP)
   - Sau khi Ä‘Äƒng nháº­p Admin, cÃ³ thá»ƒ táº¡o tÃ i khoáº£n User qua `frmQuanLyBanDoc`

> **HoÃ n thiá»‡n cÃ¡c thÃ´ng tin cÃ²n bá» trá»‘ng trÆ°á»›c khi ná»™p bÃ¡o cÃ¡o chÃ­nh thá»©c.**

---

**NgÃ y hoÃ n thÃ nh**: ......................................................  
**NgÆ°á»i duyá»‡t**: ......................................................  
=======
**PhÃ¡t triá»ƒn bá»Ÿi**: NhÃ³m sinh viÃªn  
**Thá»i gian**: 09/2024 â€“ 11/2024  
**CÃ´ng nghá»‡**: C# WinForms, Entity Framework, SQL Server
>>>>>>> 7adc9e1 (update)
